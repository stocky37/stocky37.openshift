---
# sourced from stackhpc.libvirt-host/tasks/networks.yml
- name: Ensure libvirt networks are defined
  virt_net:
    name: "{{ network.name }}"
    command: define
    xml: "{{ lookup('template', network.template) }}"
  loop: "{{ openshift_networks }}"
  loop_control:
    loop_var: network
  become: True

- name: Ensure libvirt networks are active
  virt_net:
    name: "{{ network.name }}"
    state: active
  loop: "{{ openshift_networks }}"
  loop_control:
    loop_var: network
  become: True

- name: Ensure libvirt networks are started on boot
  virt_net:
    name: "{{ network.name }}"
    autostart: yes
  loop: "{{ openshift_networks }}"
  loop_control:
    loop_var: network
  become: True
